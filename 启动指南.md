# 🚀 启动指南

如果项目无法启动，请按照以下步骤排查和解决问题。

---

## ✅ 快速诊断

### 方法1：使用诊断工具（推荐）

1. **启动HTTP服务器**
   ```bash
   # Windows PowerShell（在项目目录下）
   cd C:\Users\Administrator\Desktop\3DModel
   py -m http.server 8000
   ```

2. **访问诊断页面**
   ```
   http://localhost:8000/tests/diagnostic.html
   ```
   
   这个页面会自动检测：
   - ✅ Three.js 是否正常加载
   - ✅ GLTFLoader 是否正常加载
   - ✅ 所有9个项目模块是否正常
   - ✅ 详细的错误信息

3. **根据诊断结果**
   - 🟢 全部通过：点击"前往主页"按钮
   - 🔴 有失败项：查看错误详情，按下方步骤排查

---

## 🔍 常见问题排查

### 问题1：服务器无法启动

#### 症状
```
py -m http.server 8000
```
提示错误或无响应

#### 解决方案

**方案A：检查Python是否安装**
```bash
# 检查Python版本
py --version
# 或
python --version
```

如果提示"未找到命令"，需要安装Python：
1. 访问 https://www.python.org/downloads/
2. 下载并安装最新版本
3. 重启命令行

**方案B：端口被占用**
```bash
# 使用其他端口
py -m http.server 8001
# 然后访问 http://localhost:8001
```

**方案C：使用其他服务器**
```bash
# 如果安装了Node.js
npx http-server -p 8000

# 或使用VS Code的Live Server扩展
# 右键 index.html -> Open with Live Server
```

---

### 问题2：页面空白或无样式

#### 症状
- 页面打开了但是完全空白
- 只有文字没有颜色和布局
- 浏览器控制台有CSS错误

#### 解决方案

**方案A：确认使用HTTP服务器**
```
❌ 错误：file:///C:/Users/.../index.html
✅ 正确：http://localhost:8000/index.html
```

ES6模块必须通过HTTP/HTTPS访问，不能直接双击HTML文件打开。

**方案B：清除浏览器缓存**
1. 访问：http://localhost:8000/tests/start-fresh.html
2. 点击"强制刷新页面"按钮
3. 或按 `Ctrl + Shift + R` 强制刷新

**方案C：检查styles.css**
```bash
# 确认styles.css文件不是空的
dir styles.css
```
文件大小应该约为 7KB，如果是 0 字节，说明文件有问题。

---

### 问题3：浏览器控制台报错

#### 症状
- 打开浏览器开发者工具（F12）
- Console标签中显示红色错误信息

#### 常见错误和解决方案

**错误A：CORS 跨域错误**
```
Access to script at 'file:///.../main.js' has been blocked by CORS policy
```
**解决**：必须使用HTTP服务器，不能用file://协议

**错误B：模块加载失败**
```
Failed to load module script: Expected a JavaScript module script but the server responded with a MIME type of "text/plain"
```
**解决**：确认通过HTTP服务器访问，不是直接打开文件

**错误C：THREE is not defined**
```
Uncaught ReferenceError: THREE is not defined
```
**解决**：
1. 检查网络连接（需要加载CDN资源）
2. 访问诊断页面检查Three.js是否加载成功
3. 查看Network标签确认CDN请求是否成功

**错误D：模块导入路径错误**
```
Failed to resolve module specifier "./scene.js"
```
**解决**：
1. 确认所有文件都在正确位置
2. 查看项目结构是否完整
3. 检查文件名大小写是否正确

---

### 问题4：3D场景不显示

#### 症状
- 页面正常显示
- 上传功能正常
- 但是3D渲染区域是黑色或空白

#### 解决方案

**方案A：检查Canvas元素**
打开浏览器控制台，输入：
```javascript
document.getElementById('threeCanvas')
```
应该返回一个canvas元素，如果是null说明HTML有问题。

**方案B：检查应用初始化**
在控制台输入：
```javascript
window.app
```
应该返回App对象。如果是undefined，说明main.js没有正确执行。

**方案C：检查WebGL支持**
访问：https://get.webgl.org/
确认浏览器支持WebGL。

---

## 📋 完整启动检查清单

### 第一步：环境检查
- [ ] 已安装Python（`py --version` 能正常显示版本）
- [ ] 项目文件完整（11个JS文件 + index.html + styles.css）
- [ ] 浏览器支持WebGL（访问 https://get.webgl.org/ 测试）

### 第二步：启动服务器
- [ ] 在项目目录下运行 `py -m http.server 8000`
- [ ] 看到 "Serving HTTP on :: port 8000" 消息
- [ ] 没有报错信息

### 第三步：访问诊断页面
- [ ] 浏览器访问 `http://localhost:8000/tests/diagnostic.html`
- [ ] 等待所有检测完成
- [ ] 确认所有项显示 ✅（绿色对勾）

### 第四步：访问主页
- [ ] 访问 `http://localhost:8000/index.html`
- [ ] 看到紫色渐变背景
- [ ] 看到"3D卡片翻转效果"标题
- [ ] 看到3D渲染区域（中间有一个默认的卡片在旋转）

### 第五步：测试功能
- [ ] 上传图片可以创建3D卡片
- [ ] 自动旋转按钮可以切换状态
- [ ] 鼠标移动可以控制卡片
- [ ] 滚轮可以缩放

---

## 🛠️ 高级调试

### 查看所有模块加载状态
在浏览器控制台输入：
```javascript
// 查看应用实例
console.log(window.app);

// 查看各个管理器
console.log(app.getSceneManager());
console.log(app.getModelManager());
console.log(app.getControlsManager());
console.log(app.getUploadManager());

// 查看子系统
const scene = app.getSceneManager();
console.log(scene.getRendererManager());
console.log(scene.getCameraManager());
console.log(scene.getLightingManager());
```

### 查看渲染信息
```javascript
const renderer = app.getSceneManager().getRendererManager();
console.log(renderer.getRenderInfo());
```

### 手动测试功能
```javascript
// 旋转模型
app.getModelManager().rotate(Math.PI / 4);

// 调整相机
app.getSceneManager().adjustCameraDistance(2);

// 切换旋转模式
app.getControlsManager().setAutoRotate(true);
```

---

## 📞 还是不行？

### 使用测试页面
如果主页面有问题，尝试访问测试页面：

```bash
# 1. 诊断工具（检测所有模块）
http://localhost:8000/tests/diagnostic.html

# 2. 完整测试（测试所有功能）
http://localhost:8000/tests/test-modules.html

# 3. API示例（查看代码示例）
http://localhost:8000/tests/example-usage.html

# 4. 缓存清理（清除缓存）
http://localhost:8000/tests/start-fresh.html
```

### 检查文件完整性
确认以下文件存在且非空：

**核心文件（必须）**
- ✅ `index.html` (约3.7KB)
- ✅ `styles.css` (约7KB) ⚠️ 不能是0字节
- ✅ `main.js` (约2.5KB)
- ✅ `scene.js` (约4KB)
- ✅ `renderer.js` (约3.4KB)
- ✅ `camera.js` (约3.7KB)
- ✅ `lighting.js` (约6.2KB)
- ✅ `model.js` (约16KB)
- ✅ `upload.js` (约4.2KB)
- ✅ `controls.js` (约3.5KB)
- ✅ `utils.js` (约2.3KB)

### 重新下载项目
如果文件不完整，可能需要重新获取完整的项目文件。

---

## 📚 相关文档

- **[README.md](README.md)** - 项目主文档
- **[故障排查指南.md](故障排查指南.md)** - 详细的故障排查
- **[tests/README.md](tests/README.md)** - 测试说明
- **[API.md](API.md)** - API文档

---

## 💡 提示

1. **最常见的问题**：没有使用HTTP服务器，直接双击HTML文件打开
   - ❌ 不能用：file:///
   - ✅ 必须用：http://localhost:8000/

2. **第二常见的问题**：浏览器缓存了旧版本
   - 解决：访问 start-fresh.html 清理缓存
   - 或者按 Ctrl + Shift + R 强制刷新

3. **第三常见的问题**：端口被占用
   - 解决：更换端口 `py -m http.server 8001`

4. **网络问题**：CDN资源加载失败
   - 检查网络连接
   - 查看浏览器Network标签
   - 确认可以访问 jsdelivr.net

---

**祝您使用顺利！** 🎉

如果按照这个指南还是无法启动，请提供：
1. 具体的错误信息（截图或文字）
2. 浏览器控制台的错误（F12 -> Console）
3. 诊断页面的检测结果

