<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APIä½¿ç”¨ç¤ºä¾‹</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .example-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        
        .example-title {
            color: white;
            font-size: 1.5rem;
            margin-bottom: 15px;
        }
        
        .example-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 20px;
            font-size: 1rem;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .example-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .code-block {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin-top: 10px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>APIä½¿ç”¨ç¤ºä¾‹</h1>
        <p class="description">æ¼”ç¤ºå¦‚ä½•é€šè¿‡ç¼–ç¨‹æ–¹å¼è°ƒç”¨3Då¡ç‰‡APIæ¥å£</p>
        
        <div class="main-content" style="grid-template-columns: 1fr;">
            <!-- ç¤ºä¾‹1: ä»URLåˆ›å»ºå¡ç‰‡ -->
            <div class="example-section">
                <h2 class="example-title">ç¤ºä¾‹1: ä»å›¾ç‰‡URLåˆ›å»º3Då¡ç‰‡</h2>
                <button class="example-btn" onclick="createCardFromURLs()">åˆ›å»ºå¡ç‰‡ï¼ˆä½¿ç”¨ç¤ºä¾‹å›¾ç‰‡ï¼‰</button>
                <div class="code-block">
async function createCardFromURLs() {<br>
&nbsp;&nbsp;const frontURL = '../Relique_eInvite_FAOL.jpg';<br>
&nbsp;&nbsp;const backURL = '../Relique_eInvite_FAOL.jpg';<br>
&nbsp;&nbsp;const frontData = await urlToDataURL(frontURL);<br>
&nbsp;&nbsp;const backData = await urlToDataURL(backURL);<br>
&nbsp;&nbsp;await app.getUploadManager().createCard({<br>
&nbsp;&nbsp;&nbsp;&nbsp;frontImageData: frontData,<br>
&nbsp;&nbsp;&nbsp;&nbsp;backImageData: backData<br>
&nbsp;&nbsp;});<br>
}
                </div>
            </div>
            
            <!-- ç¤ºä¾‹2: æ§åˆ¶æ—‹è½¬ -->
            <div class="example-section">
                <h2 class="example-title">ç¤ºä¾‹2: æ§åˆ¶å¡ç‰‡æ—‹è½¬</h2>
                <button class="example-btn" onclick="enableAutoRotate()">å¼€å¯è‡ªåŠ¨æ—‹è½¬</button>
                <button class="example-btn" onclick="disableAutoRotate()">å…³é—­è‡ªåŠ¨æ—‹è½¬</button>
                <button class="example-btn" onclick="rotateToAngle(0)">æ—‹è½¬åˆ°0Â°</button>
                <button class="example-btn" onclick="rotateToAngle(90)">æ—‹è½¬åˆ°90Â°</button>
                <button class="example-btn" onclick="rotateToAngle(180)">æ—‹è½¬åˆ°180Â°</button>
                <div class="code-block">
// å¼€å¯è‡ªåŠ¨æ—‹è½¬<br>
app.getControlsManager().setAutoRotate(true);<br>
<br>
// å…³é—­è‡ªåŠ¨æ—‹è½¬<br>
app.getControlsManager().setAutoRotate(false);<br>
<br>
// æ—‹è½¬åˆ°æŒ‡å®šè§’åº¦<br>
app.getModelManager().setRotation(Math.PI / 2); // 90åº¦
                </div>
            </div>
            
            <!-- ç¤ºä¾‹3: è°ƒæ•´ç›¸æœº -->
            <div class="example-section">
                <h2 class="example-title">ç¤ºä¾‹3: è°ƒæ•´ç›¸æœºè·ç¦»</h2>
                <button class="example-btn" onclick="adjustCamera(-2)">æ‹‰è¿‘</button>
                <button class="example-btn" onclick="adjustCamera(2)">æ‹‰è¿œ</button>
                <button class="example-btn" onclick="resetCamera()">é‡ç½®è·ç¦»</button>
                <div class="code-block">
// æ‹‰è¿‘ç›¸æœº<br>
app.getSceneManager().adjustCameraDistance(-2);<br>
<br>
// æ‹‰è¿œç›¸æœº<br>
app.getSceneManager().adjustCameraDistance(2);<br>
<br>
// é‡ç½®åˆ°é»˜è®¤è·ç¦»<br>
const sceneManager = app.getSceneManager();<br>
sceneManager.camera.position.z = 6;
                </div>
            </div>
            
            <!-- ç¤ºä¾‹4: åŠ¨ç”»æ§åˆ¶ -->
            <div class="example-section">
                <h2 class="example-title">ç¤ºä¾‹4: åŠ¨ç”»ç‰¹æ•ˆ</h2>
                <button class="example-btn" onclick="animateFlip()">ç¿»è½¬åŠ¨ç”»</button>
                <button class="example-btn" onclick="animateSpin()">æ—‹è½¬ä¸€åœˆ</button>
                <button class="example-btn" onclick="animateZoom()">ç¼©æ”¾åŠ¨ç”»</button>
                <div class="code-block">
// ç¿»è½¬åŠ¨ç”»ï¼ˆ0Â° â†’ 180Â°ï¼‰<br>
async function animateFlip() {<br>
&nbsp;&nbsp;app.getControlsManager().setAutoRotate(false);<br>
&nbsp;&nbsp;const target = Math.PI;<br>
&nbsp;&nbsp;let current = 0;<br>
&nbsp;&nbsp;const step = Math.PI / 60;<br>
&nbsp;&nbsp;const interval = setInterval(() => {<br>
&nbsp;&nbsp;&nbsp;&nbsp;current += step;<br>
&nbsp;&nbsp;&nbsp;&nbsp;app.getModelManager().setRotation(current);<br>
&nbsp;&nbsp;&nbsp;&nbsp;if (current >= target) clearInterval(interval);<br>
&nbsp;&nbsp;}, 16);<br>
}
                </div>
            </div>
            
            <!-- æ¸²æŸ“åŒºåŸŸ -->
            <div class="canvas-container">
                <canvas id="threeCanvas"></canvas>
                <div class="controls">
                    <button class="control-btn" id="autoRotateBtn">è‡ªåŠ¨æ—‹è½¬</button>
                    <button class="control-btn" id="manualRotateBtn">æ‰‹åŠ¨æ§åˆ¶</button>
                </div>
            </div>
        </div>
        
        <div class="instructions">
            <p>ğŸ’¡ æç¤ºï¼šç‚¹å‡»ä¸Šé¢çš„æŒ‰é’®æŸ¥çœ‹å„ç§APIè°ƒç”¨æ•ˆæœã€‚æ‰€æœ‰åŠŸèƒ½éƒ½å¯ä»¥é€šè¿‡ç¼–ç¨‹æ–¹å¼è°ƒç”¨ï¼</p>
            <p>ğŸ“– å®Œæ•´APIæ–‡æ¡£è¯·æŸ¥çœ‹ API.md æ–‡ä»¶</p>
        </div>
    </div>

    <!-- ä¸»å…¥å£è„šæœ¬ -->
    <script type="module">
        import app from '../main.js';
        
        // å·¥å…·å‡½æ•°ï¼šURLè½¬DataURL
        async function urlToDataURL(url) {
            return fetch(url)
                .then(response => response.blob())
                .then(blob => new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onloadend = () => resolve(reader.result);
                    reader.onerror = reject;
                    reader.readAsDataURL(blob);
                }));
        }
        
        // ====== ç¤ºä¾‹å‡½æ•° ======
        
        // ç¤ºä¾‹1: ä»URLåˆ›å»ºå¡ç‰‡
        window.createCardFromURLs = async function() {
            try {
                const frontURL = '../Relique_eInvite_FAOL.jpg';
                const backURL = '../Relique_eInvite_FAOL.jpg';
                
                const frontData = await urlToDataURL(frontURL);
                const backData = await urlToDataURL(backURL);
                
                await app.getUploadManager().createCard({
                    frontImageData: frontData,
                    backImageData: backData
                });
                
                alert('3Då¡ç‰‡åˆ›å»ºæˆåŠŸï¼');
            } catch (error) {
                console.error('åˆ›å»ºå¤±è´¥:', error);
                alert('åˆ›å»ºå¤±è´¥ï¼š' + error.message);
            }
        };
        
        // ç¤ºä¾‹2: æ§åˆ¶æ—‹è½¬
        window.enableAutoRotate = function() {
            app.getControlsManager().setAutoRotate(true);
            alert('å·²å¼€å¯è‡ªåŠ¨æ—‹è½¬');
        };
        
        window.disableAutoRotate = function() {
            app.getControlsManager().setAutoRotate(false);
            alert('å·²å…³é—­è‡ªåŠ¨æ—‹è½¬');
        };
        
        window.rotateToAngle = function(degrees) {
            app.getControlsManager().setAutoRotate(false);
            const radians = degrees * Math.PI / 180;
            app.getModelManager().setRotation(radians);
            alert(`å·²æ—‹è½¬åˆ° ${degrees}Â°`);
        };
        
        // ç¤ºä¾‹3: è°ƒæ•´ç›¸æœº
        window.adjustCamera = function(delta) {
            app.getSceneManager().adjustCameraDistance(delta);
        };
        
        window.resetCamera = function() {
            const sceneManager = app.getSceneManager();
            sceneManager.cameraDistance = 6;
            sceneManager.camera.position.z = 6;
            alert('ç›¸æœºè·ç¦»å·²é‡ç½®');
        };
        
        // ç¤ºä¾‹4: åŠ¨ç”»æ§åˆ¶
        window.animateFlip = async function() {
            app.getControlsManager().setAutoRotate(false);
            
            const target = Math.PI;
            let current = 0;
            const step = Math.PI / 60; // 60å¸§å®Œæˆ
            
            const interval = setInterval(() => {
                current += step;
                app.getModelManager().setRotation(current);
                
                if (current >= target) {
                    clearInterval(interval);
                    alert('ç¿»è½¬åŠ¨ç”»å®Œæˆï¼');
                }
            }, 16); // çº¦60fps
        };
        
        window.animateSpin = function() {
            app.getControlsManager().setAutoRotate(false);
            
            const startRotation = app.getModelManager().getRotationY();
            const target = startRotation + Math.PI * 2; // æ—‹è½¬ä¸€åœˆ
            let current = startRotation;
            const step = Math.PI * 2 / 120; // 120å¸§å®Œæˆ
            
            const interval = setInterval(() => {
                current += step;
                app.getModelManager().setRotation(current);
                
                if (current >= target) {
                    clearInterval(interval);
                    alert('æ—‹è½¬ä¸€åœˆå®Œæˆï¼');
                }
            }, 16);
        };
        
        window.animateZoom = function() {
            const sceneManager = app.getSceneManager();
            const originalDistance = sceneManager.cameraDistance;
            const targetDistance = originalDistance - 4;
            let current = originalDistance;
            const step = 0.1;
            let zoomingIn = true;
            
            const interval = setInterval(() => {
                if (zoomingIn) {
                    current -= step;
                    if (current <= targetDistance) {
                        zoomingIn = false;
                    }
                } else {
                    current += step;
                    if (current >= originalDistance) {
                        clearInterval(interval);
                        alert('ç¼©æ”¾åŠ¨ç”»å®Œæˆï¼');
                        return;
                    }
                }
                
                sceneManager.cameraDistance = current;
                sceneManager.camera.position.z = current;
            }, 16);
        };
        
        console.log('ç¤ºä¾‹é¡µé¢å·²åŠ è½½ï¼Œå¯ä»¥è°ƒç”¨å„ç§APIå‡½æ•°');
        console.log('å¯ç”¨çš„å…¨å±€å‡½æ•°:', {
            createCardFromURLs: 'async function',
            enableAutoRotate: 'function',
            disableAutoRotate: 'function',
            rotateToAngle: 'function(degrees)',
            adjustCamera: 'function(delta)',
            resetCamera: 'function',
            animateFlip: 'function',
            animateSpin: 'function',
            animateZoom: 'function'
        });
    </script>
</body>
</html>

